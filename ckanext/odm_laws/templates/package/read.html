{% ckan_extends %}
  {% block primary_content_inner %}
    {#{ super()}#}
    {% block package_description %}

      {{ super() }}

      {% if dataset_type == 'laws_record' %}

        {% block odm_laws_pdf_thumbnail %}
          {% set resources = c.pkg_dict.resources %}
          {% for resource in resources%}
            {% if resource.name == 'PDF Thumbnail' %}
              <img class="pdf_thumbnail" src='{{resource.url}}'>
            {% endif %}
          {% endfor %}
        {% endblock%}

        {% block resource_list %}
          {% snippet "package/snippets/resources_list.html", pkg=pkg, resources=pkg.resources %}
        {% endblock %}

        {% block odm_laws_semre_of_database_relationships %}
         {% set pkg_dict = c.pkg_dict %}
    		 {% set dataset_id = pkg_dict.id %}
    		 {% set relations_as_subject = h.odm_laws_semre_of_database_relationships(dataset_id,viewpoint='subject') %}
    		 {% set relations_as_object = h.odm_laws_semre_of_database_relationships(dataset_id,viewpoint='object') %}
    		 {% if relations_as_subject or relations_as_object %}
    		 		<h3>{{ _('Related laws')}}</h3>
    	      <div class="semre_of_relationships">
    					<div class="cell">
    	          <span class="parents">
    	            <ul>
    	              {% for entry in relations_as_subject %}
    	                <li>
    	                  {% set related_dataset_id = entry.__extras.object_package_id%}
    	                  {% set related_dataset_name = h.odm_laws_get_dataset_name(related_dataset_id) %}
    	                  {% if related_dataset_name %}
    	                    <a href="{{h.url_for(controller='package', type='laws_record', action='read', id=related_dataset_id)}}" target="_blank">
    	                      {{ related_dataset_name }}
    	                    </a>
    	                    {% set related_dataset_notes = h.odm_laws_get_dataset_notes(related_dataset_id, True) %}
    	                    {% if related_dataset_notes %}
    	                      <span class="notes">{{ related_dataset_notes }}</span>
    	                    {% endif %}
    	                  {% else %}
    	                    &nbsp;
    	                  {% endif %}
    	                </li>
    	              {% endfor %}
    	            </ul>
    	          </span>
    	        </div>

    	        <div class="cell">
    	          <span class="separator">></span>
    	        </div>

    	        <div class="cell">
    	          <span class="this">
    	            {{ pkg.title or pkg.name }}
    	          </span>
    	        </div>
    	        <div class="cell">
    	          <span class="separator">></span>
    	        </div>
    	        <div class="cell">
    	          <span class="children">
    	            <ul>
    	              {% for entry in relations_as_object %}
    	              <li>
    	                {% set related_dataset_id = entry.__extras.subject_package_id%}
    	                {% set related_dataset_name = h.odm_laws_get_dataset_name(related_dataset_id) %}
    	                {% if related_dataset_name %}
    	                  <a href="{{h.url_for(controller='package', type='laws_record' , action='read', id=related_dataset_id)}}" target="_blank">
    	                    {{ related_dataset_name }}
    	                  </a>
    	                  {% set related_dataset_notes = h.odm_laws_get_dataset_notes(related_dataset_id, True) %}
    	                  {% if related_dataset_notes %}
    	                    <span class="notes">{{ related_dataset_notes }}</span>
    	                  {% endif %}
    	                {% else %}
    	                  &nbsp;
    	                {% endif %}
    	              </li>
    	              {% endfor %}
    	            </ul>
    	          </span>
    	        </div>
    	      </div>
    	    	<div class="clearfix"></div>
    	    	<hr>
    			{% endif%}
      	{% endblock %}



      {% endif%}
    {% endblock %}

    {% block package_tags %}
      {% snippet "package/snippets/tags.html", tags=pkg.tags %}
    {% endblock %}

    {% block package_additional_info %}
      {% snippet "package/snippets/additional_info.html", pkg_dict=pkg %}
    {% endblock %}

{% endblock %}
